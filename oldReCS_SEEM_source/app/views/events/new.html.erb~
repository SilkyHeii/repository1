<h1>予定の追加</h1>
<p>

<style type="text/css">
table.timeline {
empty-cells: hide;
}
</style>


<table class="timeline" border="5"  align="right" valign="baseline">

<tr><th ></th><th width=55 height=30>時間</th><th width=55 colspan="10">内容</th></tr>


<!-- ------------------------------------------------------------------------- -->
<tr><td  rowspan=28></td><td align="center" bgcolor="#FA8072">欠席</td>
<% for j in 0..@events.size-1%>
<% if @time.year == @events[j].start_at.year && @time.month == @events[j].start_at.month &&  @time.day == @events[j].start_at.day %>

<% if @events[j].event == "欠席" %>
<td align=center height=27.5 bgcolor="#FAE0D2"><%= @events[j].group %></td>
<% end %>
<% end %>
<% end %></tr>

<!-- ------------------------------------------------------------------------- -->

<tr><td align="center" bgcolor="#FFB066">遅刻</td>
<% for j in 0..@events.size-1%>
<% if @time.year == @events[j].start_at.year && @time.month == @events[j].start_at.month &&  @time.day == @events[j].start_at.day %>

<% if @events[j].event == "遅刻" %>
<td align=center height=27.5 bgcolor="#FFEEB2"><%= @events[j].group  %></td>
<% end %>
<% end %>
<% end %></tr>
<!-- ------------------------------------------------------------------------- -->

<tr><td align="center" bgcolor="#F0A0F0">終日</td>
<% for j in 0..@events.size-1%>
<% if @time.year == @events[j].start_at.year && @time.month == @events[j].start_at.month &&  @time.day == @events[j].start_at.day %>

<% if @events[j].event != "遅刻" && @events[j].event != "欠席"  %>
<% if @events[j].start_at.hour == 0 && @events[j].start_at.min == 0 && @events[j].end_at.hour == 0 && @events[j].end_at.min == 0%>
<td align=center height=27.5 bgcolor="#F0D0F0"><%=  @events[j].event  %></td>
<% end %>
<% end %>
<% end %>
<% end %></tr>


<!-- ------------------------------------------------------------------------- -->

<% for i in 9..21 %>

<tr>
<td rowspan=2  height=55 align="right" valign="top"><%= i %>:00</td>

<% for j in 0..@events.size-1%>

<% if @time.year == @events[j].start_at.year && @time.month == @events[j].start_at.month &&  @time.day == @events[j].start_at.day %>
<!-- ------------------------------------------------------------------------- -->








<% if i == @events[j].start_at.hour && @events[j].start_at.min>=0 && @events[j].start_at.min<=29 %>

<% if (@events[j].start_at == @events[j].end_at) && (@events[j].event != "遅刻" && @events[j].event != "欠席") %>

<td height=27.5 rowspan=1 bgcolor="#FFFFE0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>


<!-- ------------------------------------------------------------------------- -->
<% if (@events[j].end_at.min>=31 && @events[j].end_at.min<=59) %>

<% if @events[j].event == "ミーティング" %>

<% if @events[j].group == "Web班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+2 %>"bgcolor="#ddFFFF" align=center >
<%= @events[j].group + @events[j].event %></td>

 <% elsif @events[j].group == "Net班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+2 %>"bgcolor="#EEEE88" align=center >
<%= @events[j].group + @events[j].event %></td>

<% elsif @events[j].group == "Grid班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+2 %>"bgcolor="#90EE90" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>
<td  height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+2 %>"bgcolor="#F0A0F0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% end %>

<% elsif @events[j].event != "遅刻" && @events[j].event != "欠席" %>

<td  height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+2 %>"bgcolor="#cccccc" align=center >
<%= @events[j].group + @events[j].event %></td> 


<% end %>

<!-- ------------------------------------------------------------------------- -->
<% elsif @events[j].end_at.min==0 %>

<% if @events[j].event == "ミーティング" %>

<% if @events[j].group == "Web班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#ddFFFF" align=center >
<%= @events[j].group + @events[j].event %></td>

 <% elsif @events[j].group == "Net班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#EEEE88" align=center >
<%= @events[j].group + @events[j].event %></td>

<% elsif @events[j].group == "Grid班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#90EE90" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#F0A0F0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% end %>

<% elsif @events[j].event != "遅刻" && @events[j].event != "欠席" %>

<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#cccccc" align=center >
<%= @events[j].group + @events[j].event %></td> 


<% end %>

<!-- ------------------------------------------------------------------------- -->
<% elsif @events[j].end_at.min>=1 && @events[j].end_at.min<=30 %>

<% if @events[j].event == "ミーティング" %>

<% if @events[j].group == "Web班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#ddFFFF" align=center >
<%= @events[j].group + @events[j].event %></td>

 <% elsif @events[j].group == "Net班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#EEEE88" align=center >
<%= @events[j].group + @events[j].event %></td>

<% elsif @events[j].group == "Grid班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#90EE90" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#F0A0F0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% end %>

<% elsif @events[j].event != "遅刻" && @events[j].event != "欠席" %>

<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#cccccc" align=center >
<%= @events[j].group + @events[j].event %></td> 


<% end %>
<!-- ------------------------------------------------------------------------- -->

<% end %>

<% end %>
<% end %>
<% end %>
<% end %>
</tr>





<!-- ------------------------------------------------------------------------- -->
<!-- ------------------------------------------------------------------------- -->




<tr>


<% for j in 0..@events.size-1%>

<% if @time.year == @events[j].start_at.year && @time.month == @events[j].start_at.month &&  @time.day == @events[j].start_at.day %>
<!-- ------------------------------------------------------------------------- -->



<% if i == @events[j].start_at.hour && @events[j].start_at.min>=30 && @events[j].start_at.min<=59 %>

<% if (@events[j].start_at == @events[j].end_at) && (@events[j].event != "遅刻" && @events[j].event != "欠席") %>

<td height=27.5 rowspan=1 bgcolor="#FFFFE0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>


<!-- ------------------------------------------------------------------------- -->
<% if (@events[j].end_at.min>=31 && @events[j].end_at.min<=59) %>

<% if @events[j].event == "ミーティング" %>

<% if @events[j].group == "Web班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#ddFFFF" align=center >
<%= @events[j].group + @events[j].event %></td>

 <% elsif @events[j].group == "Net班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#EEEE88" align=center >
<%= @events[j].group + @events[j].event %></td>

<% elsif @events[j].group == "Grid班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#90EE90" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>
<td  height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#F0A0F0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% end %>

<% elsif @events[j].event != "遅刻" && @events[j].event != "欠席" %>

<td  height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)+1 %>"bgcolor="#cccccc" align=center >
<%= @events[j].group + @events[j].event %></td> 


<% end %>

<!-- ------------------------------------------------------------------------- -->
<% elsif @events[j].end_at.min==0 %>

<% if @events[j].event == "ミーティング" %>

<% if @events[j].group == "Web班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)-1 %>"bgcolor="#ddFFFF" align=center >
<%= @events[j].group + @events[j].event %></td>

 <% elsif @events[j].group == "Net班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)-1 %>"bgcolor="#EEEE88" align=center >
<%= @events[j].group + @events[j].event %></td>

<% elsif @events[j].group == "Grid班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)-1 %>"bgcolor="#90EE90" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)-1 %>"bgcolor="#F0A0F0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% end %>

<% elsif @events[j].event != "遅刻" && @events[j].event != "欠席" %>

<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour)-1 %>"bgcolor="#cccccc" align=center >
<%= @events[j].group + @events[j].event %></td> 


<% end %>

<!-- ------------------------------------------------------------------------- -->
<% elsif @events[j].end_at.min>=1 && @events[j].end_at.min<=30 %>

<% if @events[j].event == "ミーティング" %>

<% if @events[j].group == "Web班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#ddFFFF" align=center >
<%= @events[j].group + @events[j].event %></td>

 <% elsif @events[j].group == "Net班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#EEEE88" align=center >
<%= @events[j].group + @events[j].event %></td>

<% elsif @events[j].group == "Grid班" %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#90EE90" align=center >
<%= @events[j].group + @events[j].event %></td>

<% else %>
<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#F0A0F0" align=center >
<%= @events[j].group + @events[j].event %></td>

<% end %>

<% elsif @events[j].event != "遅刻" && @events[j].event != "欠席" %>

<td height=27.5 rowspan="<%= 2*(@events[j].end_at.hour-@events[j].start_at.hour) %>"bgcolor="#cccccc" align=center >
<%= @events[j].group + @events[j].event %></td> 


<% end %>
<!-- ------------------------------------------------------------------------- -->

<% end %>

<% end %>
<% end %>
<% end %>
<% end %>
</tr>


<% end %>
</table></p>

<%= render 'form' %>

<%= link_to 'Back', calendar_path %>
